<!DOCTYPE html>
<html lang="my" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ငွေစာရင်းမှတ်တမ်း</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #166088;
            --background-color: #ffffff;
            --text-color: #333333;
            --card-bg: #f8f9fa;
            --border-color: #e0e0e0;
            --income-color: #2ecc71;
            --expense-color: #e74c3c;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --primary-color: #6c8fc7;
            --secondary-color: #3a7ca5;
            --background-color: #1a1a1a;
            --text-color: #f0f0f0;
            --card-bg: #2d2d2d;
            --border-color: #444444;
            --income-color: #27ae60;
            --expense-color: #c0392b;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            transition: background-color 0.3s, color 0.3s;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            background-color: var(--card-bg);
            padding: 20px;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 20px;
        }

        .profile-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        #profile-img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary-color);
        }

        .icon-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--text-color);
            padding: 5px;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon-btn:hover {
            background-color: rgba(0, 0, 0, 0.1);
        }

        .balance-card {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .balance-card h3 {
            margin-bottom: 10px;
            font-size: 18px;
        }

        .balance-amount {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .summary {
            display: flex;
            justify-content: space-around;
        }

        .summary-item {
            text-align: center;
        }

        .summary-item.income .amount {
            color: var(--income-color);
        }

        .summary-item.expense .amount {
            color: var(--expense-color);
        }

        .amount {
            font-weight: bold;
            font-size: 20px;
        }

        .transaction-form {
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
        }

        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .form-group {
            flex: 1;
            min-width: 200px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        input, select {
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
            background-color: var(--background-color);
            color: var(--text-color);
        }

        .radio-group {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        button:hover {
            opacity: 0.9;
        }

        .transaction-list {
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }

        .tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }

        .tab.active {
            border-bottom: 2px solid var(--primary-color);
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background-color: rgba(0, 0, 0, 0.05);
            font-weight: 600;
        }

        .income-row {
            color: var(--income-color);
        }

        .expense-row {
            color: var(--expense-color);
        }

        .action-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: var(--text-color);
            margin-left: 5px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close-btn {
            font-size: 24px;
            cursor: pointer;
        }

        .settings-form .form-group {
            margin-bottom: 15px;
        }

        #profile-upload {
            display: none;
        }

        .profile-preview {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary-color);
            margin: 10px auto;
            display: block;
            cursor: pointer;
        }

        .lock-section {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        #lock-toggle {
            position: relative;
            width: 60px;
            height: 30px;
            -webkit-appearance: none;
            appearance: none;
            background: #ccc;
            outline: none;
            border-radius: 15px;
            cursor: pointer;
        }

        #lock-toggle:checked {
            background: var(--primary-color);
        }

        #lock-toggle:before {
            content: '';
            position: absolute;
            width: 26px;
            height: 26px;
            border-radius: 50%;
            top: 2px;
            left: 2px;
            background: white;
            transition: 0.3s;
        }

        #lock-toggle:checked:before {
            left: calc(100% - 28px);
        }

        .export-btn {
            background-color: var(--income-color);
            margin-top: 20px;
        }

        .password-modal {
            display: none;
        }

        .password-input {
            margin-top: 15px;
            width: 100%;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid var(--border-color);
        }

        .language-selector {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }

        .language-btn {
            padding: 8px 15px;
            border-radius: 5px;
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            cursor: pointer;
        }

        .language-btn.active {
            background-color: var(--primary-color);
            color: white;
        }

        /* Fix for light mode text visibility */
        [data-theme="light"] .language-btn:not(.active) {
            color: #333;
        }

        /* Custom date input styling */
        .date-input-container {
            position: relative;
        }

        .date-input-container::after {
            content: '▼';
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            pointer-events: none;
            color: var(--text-color);
            font-size: 12px;
        }

        #date {
            padding-right: 30px;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 10px;
            }
            
            .form-group {
                min-width: 100%;
            }
            
            th, td {
                padding: 8px 10px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="profile-section">
                <img id="profile-img" src="https://ui-avatars.com/api/?name=User&background=4a6fa5&color=fff" alt="Profile">
                <h2 id="profile-name">အသုံးပြုသူ</h2>
            </div>
            <div>
                <button id="language-toggle" class="language-btn active" data-lang="my">မြန်မာ</button>
                <button id="language-toggle" class="language-btn" data-lang="en">English</button>
                <button id="theme-toggle" class="icon-btn">🌓</button>
                <button id="settings-btn" class="icon-btn">⚙️</button>
            </div>
        </header>

        <main>
            <div class="balance-card">
                <h3 id="balance-title">လက်ကျန်ငွေ</h3>
                <div class="balance-amount" id="balance">0</div>
                <div class="summary">
                    <div class="summary-item income">
                        <div class="label" id="income-label">အဝင်ငွေ</div>
                        <div class="amount" id="total-income">0</div>
                    </div>
                    <div class="summary-item expense">
                        <div class="label" id="expense-label">အထွက်ငွေ</div>
                        <div class="amount" id="total-expense">0</div>
                    </div>
                </div>
            </div>

            <div class="transaction-form">
                <h3 id="add-transaction-title">ငွေစာရင်းထည့်ရန်</h3>
                <form id="transactionForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="amount" id="amount-label">ပမာဏ</label>
                            <input type="number" id="amount" placeholder="0" required>
                        </div>
                        <div class="form-group">
                            <label for="transactionType" id="type-label">အမျိုးအစား</label>
                            <select id="transactionType" required>
                                <option value="income" id="income-option">အဝင်ငွေ</option>
                                <option value="expense" id="expense-option">အထွက်ငွေ</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group date-input-container">
                            <label for="date" id="date-label">ရက်စွဲ</label>
                            <input type="date" id="date" required>
                        </div>
                        <div class="form-group">
                            <label for="description" id="description-label">မှတ်ချက်</label>
                            <input type="text" id="description" placeholder="မှတ်ချက်ထည့်ရန်">
                        </div>
                    </div>
                    <button type="submit" id="add-transaction-btn">ငွေစာရင်းထည့်မည်</button>
                </form>
            </div>

            <div class="transaction-list">
                <div class="tabs">
                    <div class="tab active" data-tab="all" id="all-tab">အားလုံး</div>
                    <div class="tab" data-tab="income" id="income-tab">အဝင်ငွေ</div>
                    <div class="tab" data-tab="expense" id="expense-tab">အထွက်ငွေ</div>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th id="date-header">ရက်စွဲ</th>
                            <th id="desc-header">မှတ်ချက်</th>
                            <th id="amount-header">ပမာဏ</th>
                            <th id="action-header">လုပ်ဆောင်ချက်များ</th>
                        </tr>
                    </thead>
                    <tbody id="transactionsTable">
                        <!-- Transactions will be added here -->
                    </tbody>
                </table>
            </div>
        </main>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="settings-title">ဆက်တင်များ</h2>
                <span class="close-btn">&times;</span>
            </div>
            <form id="settingsForm">
                <div class="form-group">
                    <label id="profile-pic-label">ဓာတ်ပုံ</label>
                    <img id="profile-preview" class="profile-preview" src="https://ui-avatars.com/api/?name=User&background=4a6fa5&color=fff" alt="Profile Preview">
                    <input type="file" id="profile-upload" accept="image/*">
                    <button type="button" id="upload-btn">ဓာတ်ပုံပြောင်းရန်</button>
                </div>
                <div class="form-group">
                    <label for="user-name" id="name-label">သင့်နာမည်</label>
                    <input type="text" id="user-name" placeholder="နာမည်ထည့်ပါ">
                </div>
                
                <div class="lock-section">
                    <label for="lock-toggle" id="lock-label">ငွေစာရင်းသော့ခတ်ရန်:</label>
                    <input type="checkbox" id="lock-toggle">
                </div>
                
                <div id="password-section" style="display: none;">
                    <input type="password" id="password-input" class="password-input" placeholder="စကားဝှက်ထည့်ပါ">
                    <button type="button" id="set-password-btn" style="margin-top: 10px;">စကားဝှက်သတ်မှတ်မည်</button>
                </div>
                
                <div id="change-password-section" style="display: none; margin-top: 15px;">
                    <h4 id="change-password-title">စကားဝှက်ပြောင်းရန်</h4>
                    <input type="password" id="current-password" class="password-input" placeholder="လက်ရှိစကားဝှက်">
                    <input type="password" id="new-password" class="password-input" placeholder="စကားဝှက်အသစ်" style="margin-top: 10px;">
                    <button type="button" id="change-password-btn" style="margin-top: 10px;">စကားဝှက်ပြောင်းမည်</button>
                </div>
                
                <div class="form-group">
                    <h3 id="history-title">ငွေစာရင်းမှတ်တမ်း</h3>
                    <div style="max-height: 200px; overflow-y: auto; margin-top: 10px;">
                        <table>
                            <thead>
                                <tr>
                                    <th id="history-date">ရက်စွဲ</th>
                                    <th id="history-type">အမျိုးအစား</th>
                                    <th id="history-amount">ပမာဏ</th>
                                </tr>
                            </thead>
                            <tbody id="historyTable">
                                <!-- History will be added here -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <button type="button" id="export-pdf" class="export-btn">PDF ထုတ်ရန်</button>
            </form>
        </div>
    </div>

    <!-- Password Modal -->
    <div class="modal password-modal" id="passwordModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="password-modal-title">စကားဝှက်ထည့်ပါ</h2>
                <span class="close-btn">&times;</span>
            </div>
            <div class="form-group">
                <input type="password" id="unlock-password" class="password-input" placeholder="စကားဝှက်">
                <button type="button" id="unlock-btn" style="margin-top: 15px;">ဖွင့်မည်</button>
            </div>
        </div>
    </div>

    <script>
        // DOM Elements
        const themeToggle = document.getElementById('theme-toggle');
        const settingsBtn = document.getElementById('settings-btn');
        const settingsModal = document.getElementById('settingsModal');
        const passwordModal = document.getElementById('passwordModal');
        const closeBtns = document.querySelectorAll('.close-btn');
        const profileImg = document.getElementById('profile-img');
        const profilePreview = document.getElementById('profile-preview');
        const profileName = document.getElementById('profile-name');
        const userNameInput = document.getElementById('user-name');
        const uploadBtn = document.getElementById('upload-btn');
        const profileUpload = document.getElementById('profile-upload');
        const lockToggle = document.getElementById('lock-toggle');
        const passwordSection = document.getElementById('password-section');
        const changePasswordSection = document.getElementById('change-password-section');
        const passwordInput = document.getElementById('password-input');
        const currentPasswordInput = document.getElementById('current-password');
        const newPasswordInput = document.getElementById('new-password');
        const setPasswordBtn = document.getElementById('set-password-btn');
        const changePasswordBtn = document.getElementById('change-password-btn');
        const unlockPassword = document.getElementById('unlock-password');
        const unlockBtn = document.getElementById('unlock-btn');
        const exportPdfBtn = document.getElementById('export-pdf');
        const transactionForm = document.getElementById('transactionForm');
        const transactionsTable = document.getElementById('transactionsTable');
        const historyTable = document.getElementById('historyTable');
        const balanceDisplay = document.getElementById('balance');
        const totalIncomeDisplay = document.getElementById('total-income');
        const totalExpenseDisplay = document.getElementById('total-expense');
        const tabs = document.querySelectorAll('.tab');
        const languageToggles = document.querySelectorAll('#language-toggle');
        const transactionTypeSelect = document.getElementById('transactionType');

        // App State
        let transactions = JSON.parse(localStorage.getItem('transactions')) || [];
        let isLocked = localStorage.getItem('isLocked') === 'true';
        let currentTab = 'all';
        let userName = localStorage.getItem('userName') || 'အသုံးပြုသူ';
        let profileImage = localStorage.getItem('profileImage') || 'https://ui-avatars.com/api/?name=User&background=4a6fa5&color=fff';
        let password = localStorage.getItem('password') || '';
        let currentLanguage = localStorage.getItem('language') || 'my';

        // Language texts
        const languageTexts = {
            my: {
                balanceTitle: 'လက်ကျန်ငွေ',
                incomeLabel: 'အဝင်ငွေ',
                expenseLabel: 'အထွက်ငွေ',
                addTransactionTitle: 'ငွေစာရင်းထည့်ရန်',
                typeLabel: 'အမျိုးအစား',
                amountLabel: 'ပမာဏ',
                dateLabel: 'ရက်စွဲ',
                descriptionLabel: 'မှတ်ချက်',
                descriptionPlaceholder: 'မှတ်ချက်ထည့်ရန်',
                addTransactionBtn: 'ငွေစာရင်းထည့်မည်',
                allTab: 'အားလုံး',
                incomeTab: 'အဝင်ငွေ',
                expenseTab: 'အထွက်ငွေ',
                dateHeader: 'ရက်စွဲ',
                descHeader: 'မှတ်ချက်',
                amountHeader: 'ပမာဏ',
                actionHeader: 'လုပ်ဆောင်ချက်များ',
                settingsTitle: 'ဆက်တင်များ',
                profilePicLabel: 'ဓာတ်ပုံ',
                nameLabel: 'သင့်နာမည်',
                namePlaceholder: 'နာမည်ထည့်ပါ',
                lockLabel: 'ငွေစာရင်းသော့ခတ်ရန်:',
                historyTitle: 'ငွေစာရင်းမှတ်တမ်း',
                historyDate: 'ရက်စွဲ',
                historyType: 'အမျိုးအစား',
                historyAmount: 'ပမာဏ',
                exportBtn: 'PDF ထုတ်ရန်',
                passwordModalTitle: 'စကားဝှက်ထည့်ပါ',
                unlockBtn: 'ဖွင့်မည်',
                setPasswordBtn: 'စကားဝှက်သတ်မှတ်မည်',
                uploadBtn: 'ဓာတ်ပုံပြောင်းရန်',
                passwordInputPlaceholder: 'စကားဝှက်ထည့်ပါ',
                unlockPasswordPlaceholder: 'စကားဝှက်',
                changePasswordTitle: 'စကားဝှက်ပြောင်းရန်',
                currentPasswordPlaceholder: 'လက်ရှိစကားဝှက်',
                newPasswordPlaceholder: 'စကားဝှက်အသစ်',
                changePasswordBtn: 'စကားဝှက်ပြောင်းမည်',
                noTransactions: 'ငွေစာရင်းမရှိပါ',
                noHistory: 'ငွေစာရင်းမရှိသေးပါ',
                confirmDelete: 'ဤငွေစာရင်းကိုဖျက်ရန်သေချာပါသလား?',
                passwordSet: 'စကားဝှက်သတ်မှတ်ပြီး ငွေစာရင်းသော့ခတ်ထားသည်',
                passwordChanged: 'စကားဝှက်ပြောင်းလဲပြီးပါပြီ',
                passwordRequired: 'စကားဝှက်အသစ်ထည့်ပါ',
                wrongPassword: 'လက်ရှိစကားဝှက်မှားနေပါသည်',
                invalidPassword: 'စကားဝှက်မှားနေပါသည်',
                requiredFields: 'ကျေးဇူးပြု၍ လိုအပ်သောအချက်များဖြည့်ပါ',
                reportTitle: 'ငွေစာရင်းအစီရင်ခံစာ',
                generatedOn: 'ထုတ်သည့်ရက်',
                userLabel: 'အသုံးပြုသူ:',
                footerText: 'ငွေစာရင်းမှတ်တမ်းမှထုတ်သည့်'
            },
            en: {
                balanceTitle: 'Balance',
                incomeLabel: 'Income',
                expenseLabel: 'Expense',
                addTransactionTitle: 'Add Transaction',
                typeLabel: 'Type',
                amountLabel: 'Amount',
                dateLabel: 'Date',
                descriptionLabel: 'Description',
                descriptionPlaceholder: 'Enter description',
                addTransactionBtn: 'Add Transaction',
                allTab: 'All',
                incomeTab: 'Income',
                expenseTab: 'Expense',
                dateHeader: 'Date',
                descHeader: 'Description',
                amountHeader: 'Amount',
                actionHeader: 'Actions',
                settingsTitle: 'Settings',
                profilePicLabel: 'Profile Picture',
                nameLabel: 'Your Name',
                namePlaceholder: 'Enter name',
                lockLabel: 'Lock Account:',
                historyTitle: 'Transaction History',
                historyDate: 'Date',
                historyType: 'Type',
                historyAmount: 'Amount',
                exportBtn: 'Export PDF',
                passwordModalTitle: 'Enter Password',
                unlockBtn: 'Unlock',
                setPasswordBtn: 'Set Password',
                uploadBtn: 'Change Photo',
                passwordInputPlaceholder: 'Enter password',
                unlockPasswordPlaceholder: 'Password',
                changePasswordTitle: 'Change Password',
                currentPasswordPlaceholder: 'Current Password',
                newPasswordPlaceholder: 'New Password',
                changePasswordBtn: 'Change Password',
                noTransactions: 'No transactions',
                noHistory: 'No transaction history',
                confirmDelete: 'Are you sure you want to delete this transaction?',
                passwordSet: 'Password set and account locked',
                passwordChanged: 'Password changed successfully',
                passwordRequired: 'Please enter new password',
                wrongPassword: 'Current password is incorrect',
                invalidPassword: 'Invalid password',
                requiredFields: 'Please fill required fields',
                reportTitle: 'Transaction Report',
                generatedOn: 'Generated on',
                userLabel: 'User:',
                footerText: 'Generated from Transaction Record'
            }
        };

        // Initialize
        function init() {
            // Set initial theme
            if (localStorage.getItem('theme') === 'dark') {
                document.documentElement.setAttribute('data-theme', 'dark');
                themeToggle.textContent = '🌞';
            }

            // Set profile data
            profileName.textContent = userName;
            profileImg.src = profileImage;
            profilePreview.src = profileImage;
            userNameInput.value = userName;
            lockToggle.checked = isLocked;
            passwordSection.style.display = isLocked ? 'block' : 'none';
            changePasswordSection.style.display = password ? 'block' : 'none';

            // Set current date as default (formatted as dd/mm/yyyy)
            const today = new Date();
            const formattedDate = formatDateForInput(today);
            document.getElementById('date').value = formattedDate;

            // Set language
            setLanguage(currentLanguage);
            
            // Load transactions
            updateTransactionsDisplay();
            updateBalance();
            updateHistoryDisplay();
        }

        // Format date as dd/mm/yyyy for input field
        function formatDateForInput(date) {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${year}-${month}-${day}`;
        }

        // Format date as dd/mm/yy for display
        function formatDateDisplay(dateString) {
            const date = new Date(dateString);
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = String(date.getFullYear()).slice(-2);
            return `${day}/${month}/${year}`;
        }

        // Set language
        function setLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('language', lang);
            
            // Update language toggle buttons
            languageToggles.forEach(btn => {
                if (btn.dataset.lang === lang) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
            
            // Update all text elements
            const texts = languageTexts[lang];
            
            document.getElementById('balance-title').textContent = texts.balanceTitle;
            document.getElementById('income-label').textContent = texts.incomeLabel;
            document.getElementById('expense-label').textContent = texts.expenseLabel;
            document.getElementById('add-transaction-title').textContent = texts.addTransactionTitle;
            document.getElementById('type-label').textContent = texts.typeLabel;
            document.getElementById('income-option').textContent = texts.incomeLabel;
            document.getElementById('expense-option').textContent = texts.expenseLabel;
            document.getElementById('amount-label').textContent = texts.amountLabel;
            document.getElementById('date-label').textContent = texts.dateLabel;
            document.getElementById('description-label').textContent = texts.descriptionLabel;
            document.getElementById('description').placeholder = texts.descriptionPlaceholder;
            document.getElementById('add-transaction-btn').textContent = texts.addTransactionBtn;
            document.getElementById('all-tab').textContent = texts.allTab;
            document.getElementById('income-tab').textContent = texts.incomeTab;
            document.getElementById('expense-tab').textContent = texts.expenseTab;
            document.getElementById('date-header').textContent = texts.dateHeader;
            document.getElementById('desc-header').textContent = texts.descHeader;
            document.getElementById('amount-header').textContent = texts.amountHeader;
            document.getElementById('action-header').textContent = texts.actionHeader;
            document.getElementById('settings-title').textContent = texts.settingsTitle;
            document.getElementById('profile-pic-label').textContent = texts.profilePicLabel;
            document.getElementById('name-label').textContent = texts.nameLabel;
            document.getElementById('user-name').placeholder = texts.namePlaceholder;
            document.getElementById('lock-label').textContent = texts.lockLabel;
            document.getElementById('history-title').textContent = texts.historyTitle;
            document.getElementById('history-date').textContent = texts.historyDate;
            document.getElementById('history-type').textContent = texts.historyType;
            document.getElementById('history-amount').textContent = texts.historyAmount;
            document.getElementById('export-pdf').textContent = texts.exportBtn;
            document.getElementById('password-modal-title').textContent = texts.passwordModalTitle;
            document.getElementById('unlock-btn').textContent = texts.unlockBtn;
            document.getElementById('set-password-btn').textContent = texts.setPasswordBtn;
            document.getElementById('upload-btn').textContent = texts.uploadBtn;
            document.getElementById('password-input').placeholder = texts.passwordInputPlaceholder;
            document.getElementById('unlock-password').placeholder = texts.unlockPasswordPlaceholder;
            document.getElementById('change-password-title').textContent = texts.changePasswordTitle;
            document.getElementById('current-password').placeholder = texts.currentPasswordPlaceholder;
            document.getElementById('new-password').placeholder = texts.newPasswordPlaceholder;
            document.getElementById('change-password-btn').textContent = texts.changePasswordBtn;
            
            // Update transactions display to reflect language change
            updateTransactionsDisplay();
            updateHistoryDisplay();
        }

        // Theme Toggle
        themeToggle.addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            if (currentTheme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'light');
                localStorage.setItem('theme', 'light');
                themeToggle.textContent = '🌓';
            } else {
                document.documentElement.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
                themeToggle.textContent = '🌞';
            }
        });

        // Language Toggle
        languageToggles.forEach(btn => {
            btn.addEventListener('click', () => {
                const lang = btn.dataset.lang;
                setLanguage(lang);
            });
        });

        // Settings Modal
        settingsBtn.addEventListener('click', () => {
            settingsModal.style.display = 'flex';
        });

        // Password Modal
        function showPasswordModal() {
            passwordModal.style.display = 'flex';
        }

        // Close Modals
        closeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                settingsModal.style.display = 'none';
                passwordModal.style.display = 'none';
            });
        });

        window.addEventListener('click', (e) => {
            if (e.target === settingsModal) {
                settingsModal.style.display = 'none';
            }
            if (e.target === passwordModal) {
                passwordModal.style.display = 'none';
            }
        });

        // Profile Image Upload
        uploadBtn.addEventListener('click', () => {
            profileUpload.click();
        });

        profileUpload.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    profileImage = event.target.result;
                    profileImg.src = profileImage;
                    profilePreview.src = profileImage;
                    localStorage.setItem('profileImage', profileImage);
                };
                reader.readAsDataURL(file);
            }
        });

        // User Name Update
        userNameInput.addEventListener('change', () => {
            userName = userNameInput.value;
            profileName.textContent = userName;
            localStorage.setItem('userName', userName);
        });

        // Lock Toggle
        lockToggle.addEventListener('change', () => {
            if (lockToggle.checked) {
                if (password) {
                    // If password exists, just enable lock
                    isLocked = true;
                    localStorage.setItem('isLocked', 'true');
                    passwordSection.style.display = 'none';
                } else {
                    // If no password, show password section
                    passwordSection.style.display = 'block';
                }
            } else {
                // Show password modal to unlock
                showPasswordModal();
            }
        });

        // Set Password
        setPasswordBtn.addEventListener('click', () => {
            if (passwordInput.value) {
                password = passwordInput.value;
                localStorage.setItem('password', password);
                isLocked = true;
                localStorage.setItem('isLocked', 'true');
                passwordSection.style.display = 'none';
                changePasswordSection.style.display = 'block';
                passwordInput.value = '';
                alert(languageTexts[currentLanguage].passwordSet);
            }
        });

        // Change Password
        changePasswordBtn.addEventListener('click', () => {
            if (currentPasswordInput.value === password) {
                if (newPasswordInput.value) {
                    password = newPasswordInput.value;
                    localStorage.setItem('password', password);
                    currentPasswordInput.value = '';
                    newPasswordInput.value = '';
                    alert(languageTexts[currentLanguage].passwordChanged);
                } else {
                    alert(languageTexts[currentLanguage].passwordRequired);
                }
            } else {
                alert(languageTexts[currentLanguage].wrongPassword);
            }
        });

        // Unlock Transactions
        unlockBtn.addEventListener('click', () => {
            if (unlockPassword.value === password) {
                isLocked = false;
                localStorage.setItem('isLocked', 'false');
                lockToggle.checked = false;
                passwordModal.style.display = 'none';
                unlockPassword.value = '';
            } else {
                alert(languageTexts[currentLanguage].invalidPassword);
            }
        });

        // Tab Switching
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                currentTab = tab.dataset.tab;
                updateTransactionsDisplay();
            });
        });

        // Add Transaction
        transactionForm.addEventListener('submit', (e) => {
            e.preventDefault();
            
            if (isLocked) {
                showPasswordModal();
                return;
            }

            const type = transactionTypeSelect.value;
            const amount = parseFloat(document.getElementById('amount').value);
            const date = document.getElementById('date').value;
            const description = document.getElementById('description').value;

            if (!amount || !date) {
                alert(languageTexts[currentLanguage].requiredFields);
                return;
            }

            const transaction = {
                id: Date.now(),
                type,
                amount,
                date,
                description,
                createdAt: new Date().toISOString()
            };

            transactions.push(transaction);
            saveTransactions();
            updateTransactionsDisplay();
            updateBalance();
            updateHistoryDisplay();

            // Reset form
            transactionForm.reset();
            document.getElementById('date').value = formatDateForInput(new Date());
        });

        // Delete Transaction
        function deleteTransaction(id) {
            if (isLocked) {
                showPasswordModal();
                return;
            }

            if (confirm(languageTexts[currentLanguage].confirmDelete)) {
                transactions = transactions.filter(t => t.id !== id);
                saveTransactions();
                updateTransactionsDisplay();
                updateBalance();
                updateHistoryDisplay();
            }
        }

        // Save Transactions to LocalStorage
        function saveTransactions() {
            localStorage.setItem('transactions', JSON.stringify(transactions));
        }

        // Update Transactions Display
        function updateTransactionsDisplay() {
            transactionsTable.innerHTML = '';

            let filteredTransactions = [...transactions];
            if (currentTab === 'income') {
                filteredTransactions = transactions.filter(t => t.type === 'income');
            } else if (currentTab === 'expense') {
                filteredTransactions = transactions.filter(t => t.type === 'expense');
            }

            // Sort by date (newest first)
            filteredTransactions.sort((a, b) => new Date(b.date) - new Date(a.date));

            if (filteredTransactions.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="4" style="text-align: center;">${languageTexts[currentLanguage].noTransactions}</td>`;
                transactionsTable.appendChild(row);
                return;
            }

            filteredTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                row.className = `${transaction.type}-row`;
                
                const formattedDate = formatDateDisplay(transaction.date);
                const formattedAmount = transaction.type === 'income' 
                    ? `+${transaction.amount.toLocaleString()}` 
                    : `-${transaction.amount.toLocaleString()}`;

                row.innerHTML = `
                    <td>${formattedDate}</td>
                    <td>${transaction.description || '-'}</td>
                    <td>${formattedAmount}</td>
                    <td>
                        <button class="action-btn" onclick="deleteTransaction(${transaction.id})">🗑️</button>
                    </td>
                `;
                transactionsTable.appendChild(row);
            });
        }

        // Update Balance Display
        function updateBalance() {
            const income = transactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + t.amount, 0);

            const expense = transactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + t.amount, 0);

            const balance = income - expense;

            balanceDisplay.textContent = balance.toLocaleString();
            totalIncomeDisplay.textContent = income.toLocaleString();
            totalExpenseDisplay.textContent = expense.toLocaleString();
        }

        // Update History Display
        function updateHistoryDisplay() {
            historyTable.innerHTML = '';

            // Get last 10 transactions for history
            const recentTransactions = [...transactions]
                .sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt))
                .slice(0, 10);

            if (recentTransactions.length === 0) {
                const row = document.createElement('tr');
                row.innerHTML = `<td colspan="3" style="text-align: center;">${languageTexts[currentLanguage].noHistory}</td>`;
                historyTable.appendChild(row);
                return;
            }

            recentTransactions.forEach(transaction => {
                const row = document.createElement('tr');
                
                const formattedDate = formatDateDisplay(transaction.date);
                const formattedType = transaction.type === 'income' ? languageTexts[currentLanguage].incomeLabel : languageTexts[currentLanguage].expenseLabel;
                const formattedAmount = transaction.type === 'income' 
                    ? `+${transaction.amount.toLocaleString()}` 
                    : `-${transaction.amount.toLocaleString()}`;

                row.innerHTML = `
                    <td>${formattedDate}</td>
                    <td>${formattedType}</td>
                    <td>${formattedAmount}</td>
                `;
                historyTable.appendChild(row);
            });
        }

        // Export to PDF
        exportPdfBtn.addEventListener('click', () => {
            const printWindow = window.open('', '_blank');
            const texts = languageTexts[currentLanguage];
            
            printWindow.document.write(`
                <html>
                    <head>
                        <title>${texts.reportTitle}</title>
                        <style>
                            body { font-family: Arial, sans-serif; padding: 20px; }
                            h1 { color: #4a6fa5; text-align: center; }
                            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                            th { background-color: #f2f2f2; }
                            .income { color: green; }
                            .expense { color: red; }
                            .summary { margin-top: 30px; display: flex; justify-content: space-around; }
                            .footer { margin-top: 50px; text-align: right; font-size: 12px; }
                        </style>
                    </head>
                    <body>
                        <h1>${texts.reportTitle}</h1>
                        <p>${texts.generatedOn} ${new Date().toLocaleDateString()}</p>
                        <p>${texts.userLabel} ${userName}</p>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>${texts.dateHeader}</th>
                                    <th>${texts.descHeader}</th>
                                    <th>${texts.historyType}</th>
                                    <th>${texts.amountHeader}</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${transactions.map(t => `
                                    <tr>
                                        <td>${formatDateDisplay(t.date)}</td>
                                        <td>${t.description || '-'}</td>
                                        <td>${t.type === 'income' ? texts.incomeLabel : texts.expenseLabel}</td>
                                        <td class="${t.type}">${
                                            t.type === 'income' 
                                            ? `+${t.amount.toLocaleString()}` 
                                            : `-${t.amount.toLocaleString()}`
                                        }</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                        
                        <div class="summary">
                            <div>
                                <strong>${texts.incomeLabel}:</strong> ${transactions
                                    .filter(t => t.type === 'income')
                                    .reduce((sum, t) => sum + t.amount, 0)
                                    .toLocaleString()}
                            </div>
                            <div>
                                <strong>${texts.expenseLabel}:</strong> ${transactions
                                    .filter(t => t.type === 'expense')
                                    .reduce((sum, t) => sum + t.amount, 0)
                                    .toLocaleString()}
                            </div>
                            <div>
                                <strong>${texts.balanceTitle}:</strong> ${(
                                    transactions.filter(t => t.type === 'income').reduce((sum, t) => sum + t.amount, 0) -
                                    transactions.filter(t => t.type === 'expense').reduce((sum, t) => sum + t.amount, 0)
                                ).toLocaleString()}
                            </div>
                        </div>
                        
                        <div class="footer">
                            ${texts.footerText}
                        </div>
                    </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        });

        // Make deleteTransaction available globally
        window.deleteTransaction = deleteTransaction;

        // Initialize the app
        init();
    </script>
</body>
</html>